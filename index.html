<!DOCTYPE html>
<html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>trifl - trifling functional views</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="css/base.css"><link rel="stylesheet" href="css/prism.css"><link rel="stylesheet" href="css/styles.css"></head><body><div class="top"><div class="container"><h1>trifl</h1><p>a functional web client user interface library with a unidirectional dataflow and a virtual dom.</p><p>Trifl provides some simple components to structure web applications. There are <b>actions</b> to aid a unidirectional data flow,<b> views</b> to visualize your model state as it changes and <b>router</b> to glue the url to actions and views.</p><p>Discuss <a href="https://gitter.im/algesten/trifl">trifl on gitter</a>, read the <a href="https://github.com/algesten/trifl#api">api docs</a>, review the <a href="https://github.com/algesten/trifl">code on github</a> and report <a href="https://github.com/algesten/trifl/issues">issues on github</a>.</p></div><div class="buttons"><a class="button" href="https://github.com/algesten/trifl#installation">installation</a><a class="button" href="https://github.com/algesten/trifl#api">api docs</a><a class="button fork" href="https://github.com/algesten/trifl">fork me on github</a></div></div><div class="main"><div class="container"><div class="docblock"><figure><img src="assets/trifl-flow.svg"><figcaption>figure detailing the flow of a trifl application.</figcaption></figure><p>Generally with trifl, it is encouraged to "think big", big actions, big model changes, big view updates. Trifl provides the tools to avoid micro managing model/dom updates.</p><h2>three parts</h2><p>There are three parts to trifl:<ul><li><i>Actions</i> are helper functions to aid decoupling of application parts in a unidirectional manner.</li><li><i>Views</i> are render functions whose purpose are to make dom nodes reflect some model state.</li><li>The <i>router</i> is a utility for organising a url space into visible views and firing actions as a result of url changes.</li></ul></p><h2>actions</h2><p>Actions are triggered by input or asynchronous server events such as responses to ajax.</p><p>Actions can be thought of as really bad events cause they can only have one listener: the handler. This is one part of "thinking big". Traditional events encourage micro state changes with multiple listeners scattered througout the code. In medium to large applications it quickly become very hard to get an overview of all things happening as a result of such an event.</p><p>In trifl there is only one action handler per action, and, in line with unidirectional thinking, its only responsibility is to propagate the action to the model.</p><p>Other frameworks talk about "dispatcher" as a component, and whilst trifl doesn't have an explicit such an component, we encourage to think of action handlers as dispatcher code.</p></div><div class="compare"><div class="col col-6 mobile-full"><p>Declare a dispatcher function</p><pre><code class="language-coffeescript">handler "selectarticle", (articleid) ->
    # action updates the model
    model.articles.requestArticle(articleid)

</code></pre><p>Trigger an action</p><pre><code class="language-coffeescript">action "selectarticle", "slugattack01"</code></pre></div><div class="col col-6 mobile-full"><p>Declare a dispatcher function</p><pre><code class="language-javascript">handler("selectarticle", function(articleid) {
    // action updates the model
    model.articles.requestArticle(articleid);
});</code></pre><p>Trigger an action</p><pre><code class="language-javascript">action("selectarticle", "slugattack01");</code></pre></div></div><div class="docblock"><p>Only one action can be triggered at a time. It is an error to dispatch another somewhere inside the handler (or model code executed by the handler) and doing so will result in an exception.</p><p>There is however another class of actions called <i>updates</i> that are allowed. Updates are used to signal that a model has been updated and requires re-rendering in the views.</p><h3>dispatchers and controllers</h3><p>Handlers come in two variants that work exactly the same, but are mentally separate to know what part of the code they belong in.</p><ul><li>action – <i>dispatcher function</i> (handler)</li><li>update – <i>controller function</i> (handler)</li></ul><p>Dispatchers are handlers that receive plain actions. Controllers work on the back of models marked as updated during the dispatch of an action.</p><figure><img src="assets/trifl-action2view.svg"><figcaption>figure showing action → module updates → view updates.</figcaption></figure></div><div class="compare"><div class="col col-6 mobile-full"><p>Declare a controller function</p><pre><code class="language-coffeescript">handler "update:articles", ->
    # rerender views
    views.articleCount model.articles
    views.articleView model.articles

</code></pre><p>Trigger an update (as part of an action)</p><pre><code class="language-coffeescript">model.articles = {
  requestArticle: (articleid) =>
    url = "/get/#{articleid}"
    $.ajax(url).done (article) ->
      # trigger action with the update
      action "gotarticle", article 
    @state = "requesting"
    update "articles"
}



</code></pre></div><div class="col col-6 mobile-full"><p>Declare a controller function</p><pre><code class="language-javascript">handler("selectarticle", function(articleid) {
    // render views
    views.articleCount(model.articles);
    views.articleView(model.articles);
});</code></pre><p>Trigger an update (as part of an update)</p><pre><code class="language-javascript">model.articles = {
  requestArticle: function(articleid) {
    var url = "/get" + articleid";
    var _this = this;
    $.ajax(url).done(function(data) {
      // trigger action with the update
      action("gotarticle", article);
    });
    this.state = "requesting";
    update("articles");
  }
};</code></pre></div></div><div class="docblock"><h2>views</h2><p>Views render a model state into something the user can see. Trifl ships with <a href="https://github.com/algesten/tagg">tagg</a>, configured to deep hook into <a href="https://github.com/Matt-Esch/virtual-dom">virtual-dom</a>.</p><p>In views we again "think big" and encourage to render large parts of the screen – entire models – at a time. The virtual dom will figure out the differences, and only make partial real dom changes.</p></div></div></div><script src="js/prism.js"></script><div class="footer"><div class="container"><p class="copyright">Copyright © 2015 Martin Algesten</p></div></div></body></html>